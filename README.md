CVE-2017-14105

A vulnerability in the backup and restore functionality of HiveManager
Classic could allow an authenticated, local attacker - even restricted
as a tenant - to execute arbitrary code on a targeted system.
The backup looks like a simple tar file, which contains the whole conf and
uploaded map images.  It is possible to re-create a backup archive
adding a file in any existing directory; for example, it is possible to
add a jsp at HiveManager/tomcat/webapps/hm/domains/$yourtenant/maps
(files will be exposed at the web interface).

Discovered in HiveManager Classic 8.0r1, replicated in 8.1r1.
Older version may be affected too.

Vendor replied with a wontfix because they are moving every instance to
HiveManager-NG which has dramatically different architecture, and they
believe the risk to our customer base is already low and getting lower
with time.

Steps to reproduce:
1) as authenticated users, to main VHM or to a tenant, perform a backup.
2) untar the backup and place a jsp file in HiveManager/tomcat/webapps/hm/domains/$yourtenant/maps
or in HiveManager/tomcat/webapps/hm/domains/
3) perform a restore
4) reach your jsp at https://hivemanagerip/hm/domains/$yourtenant/maps/$file.jsp or
https://hivemanagerip/hm/domains/$file.jsp

Timeline:
20170829 - vuln disclosed to vendor
20170831 - vendor replied with wontfix
20170901 - cve requests and public diclosure
